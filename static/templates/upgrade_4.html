{{define "upgrade4"}}
<script>
	$(document).ready(function() {
		$( "#progress_bar" ).load( "ajax?controllerName=progressBar");
	});
</script>
<script type="text/javascript">

	$('#save_youtube').bind('click', function () {

		var video_url = $('#video_url').val();
		$.post('ajax?controllerName=saveVideo', {'video_url' : video_url },
				function(data) {
					if (data.url != '') {

						//$('#video_url_src').attr('src') = $('#video_url').val();
						$('#video_url_iframe').html('<iframe width=640 height=480  src="'+data.url+'" frameborder=0 allowfullscreen></iframe>');
					}

				}, "json");
	});

	$('#clear_youtube').bind('click', function () {

		$.post('ajax?controllerName=clearVideo', { },
				function(data) {
					$('#video_url_iframe').html('');
					$('#video_url').val('');
				});
	});

	$('#del_mp4').bind('click', function () {
		$.post('ajax?controllerName=deleteVideo', {'type' : 'mp4' },
				function(data) {
					$('#video_mp4_ok').css("display", "none");
					$('#del_mp4').css("display", "none");
				});
	});

	$('#del_webm_ogg').bind('click', function () {
		$.post('ajax?controllerName=deleteVideo', {'type' : 'webm_ogg' },
				function(data) {
					$('#video_webm_ogg_ok').css("display", "none");
					$('#del_webm_ogg').css("display", "none");
				});
	});
	$( "#from_webcam_show" ).click(function() {
		$("#from_webcam").css("display", "block");
		$("#from_file").css("display", "none");
		return false;
	});
	$( "#from_file_show" ).click(function() {
		$("#from_file").css("display", "block");
		$("#from_webcam").css("display", "none");
		return false;
	});

	$( "#refresh_youtube" ).click(function() {
		var iframe = document.getElementById('player');
		iframe.src = iframe.src;
		console.log('player');
		return false;
	});

</script>

<script src="static/js/uploader.js"></script>
<script src="static/js/js.js"></script>

<link rel="stylesheet" href="static/css/progress.css" type="text/css" />
<h1 class="page-header">{{.Lang.upgrade_title}}</h1>
<ol class="breadcrumb">
	<li><a href="#miningMenu">{{.Lang.mining}}</a></li>
	<li class="active">{{.Lang.upgrade_title}}</li>
</ol>

<ul class="nav nav-tabs">
	{{noescape .UpgradeMenu}}
</ul>


<h3>{{.Lang.upload_face_video}}</h3>

{{noescape .Lang.upload_face_video_rules}}
{{noescape .Lang.upload_face_video_rules2}}

<p><a href="#" id="from_webcam_show">{{.Lang.from_webcam}}{{.Lang.from_file}}</a> {{.Lang.or}} <a href="#" id="from_file_show">{{.Lang.from_file}}</a></p>
<div id="from_webcam">

	<div id="widget"></div>
	<div id="player">{{if .VideoUrl}}<iframe width=640 height=480  src='{{.VideoUrl}}' frameborder=0 allowfullscreen></iframe>{{end}}</div>
	<div id="refresh_youtube_div" style="display: none"><a href="#" id="refresh_youtube"><i class="fa fa-refresh fa-fw" style="font-size: 30px"></i></a></div>

	<script src="static/js/youtube_webcam.js"></script>
</div>

<div id="from_file" style="display: none">

	<table class="table table-bordered">
		<tr><td>

			<span class="btn btn-file"><input id="video_url" type="text" value="{{.VideoUrl}}" style="width:500px"><button id="save_youtube">{{.Lang.save}}</button><button id="clear_youtube">{{.Lang.clear}}</button></span>
			<br>Example: http://www.youtube.com/watch?v=ZSt9tm3RoUU<br>
			<div id="video_url_iframe">{{if .VideoUrl}}<iframe width=640 height=480  src='{{.VideoUrl}}' frameborder=0 allowfullscreen></iframe>{{end}}</div>
		</td></tr>

		<tr><td>
			or upload mp4/mov video:<br>
			<table>
				<tr>
					<td>

						mp4:<input type="file" id="video_mp4" name="file" accept="video/mov,video/mp4" onchange="send_video('video_mp4', 'video_mp4_progress', 'user_video')" />
						<div id="video_mp4_progress" class="my_progress">0%</div><br>
						<div id="video_mp4_ok" class="alert alert-success" style="display: none"></div>
						<button id="del_mp4" style="display: none">Delete</button>

					</td>
				</tr>
			</table>
			<br>

			<div id="video" style="display: none"><video id="example_video_1" class="video-js vjs-default-skin" controls preload="none" width="640" height="468" data-setup="{}"><source src="public/{{.UserId}}_user_video.mp4" type='video/mp4' /><source src="public/{{.UserId}}_user_video.webm" type='video/webm' /><source src="public/{{.UserId}}_user_video.ogv" type='video/ogg' /></video></div>

		</td></tr>


	</table>

</div>

<script>
	{{if ne .UserVideoMp4 ""}}
		$('#video_mp4_ok').css("display", "block");
		$('#video_mp4_ok').html('{{.Lang.file_successfully_downloaded}}');
		$('#del_mp4').css("display", "block");
		$('#video').css("display", "block");
	{{end}}

	{{if or (ne .UserVideoWebm "") (ne .UserVideoOgg "")}}
		$('#video_webm_ogg_ok').css("display", "block");
		$('#video_webm_ogg_ok').html('{{.Lang.file_successfully_downloaded}}');
		$('#del_webm_ogg').css("display", "block");
		$('#video').css("display", "block");
	{{end}}
</script>

<br>

<button class="btn btn-success" onclick="$('#save_youtube').trigger('click');fc_navigate('upgrade5');">{{.SaveAndGotoStep}}</button>

<br><br><br><br><br><br><br>

<div class="for-signature"></div>
       
{{end}}